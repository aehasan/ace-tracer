(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{6792:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,a){function i(e){try{s(o.next(e))}catch(t){a(t)}}function c(e){try{s(o.throw(e))}catch(t){a(t)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}s((o=o.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.recordreplayer=t.safeChangeValue=t.replay=t.record=t.stream=t.deserializeAceRecordTimestamp=t.applyAceRecord=t.AceRecord=t.ExternalChange=t.WindowSizeChange=t.WindowSize=t.applyScrollChange=t.ScrollChange=t.ScrollPosition=t.applyCursorChange=t.CursorChange=t.applySelectionChange=t.SelectionChange=t.selectionIsEmpty=t.compareSelections=t.Selection=t.applyDelta=t.Delta=t.applyComplete=t.getComplete=t.Complete=t.compareEditorLocations=t.EditorLocation=t.AceTimestamp=void 0;const a=r(n(8709)),i=n(3e3),c=n(2691);t.AceTimestamp=(0,i.Union)((0,i.InstanceOf)(Date),i.String.withConstraint((e=>!isNaN(Date.parse(e).valueOf())))),t.EditorLocation=(0,i.Record)({row:i.Number,column:i.Number});t.compareEditorLocations=(e,t)=>e.column===t.column&&e.row===t.row,t.Complete=(0,i.Record)({type:(0,i.Literal)("complete"),timestamp:t.AceTimestamp,focused:i.Boolean,value:i.String,selection:(0,i.Record)({start:t.EditorLocation,end:t.EditorLocation}),cursor:t.EditorLocation,scroll:(0,i.Record)({top:i.Number,left:i.Number})});t.getComplete=e=>t.Complete.check({type:"complete",timestamp:new Date,focused:e.isFocused(),value:e.getValue(),selection:e.selection.getRange(),cursor:e.selection.getCursor(),scroll:{top:e.renderer.getScrollTop(),left:e.renderer.getScrollLeft()}});t.applyComplete=(e,n,o=!1)=>{if(e.getValue()!==n.value&&(0,t.safeChangeValue)(e,n.value),o)return;const{row:r,column:a}=n.cursor;e.selection.moveCursorTo(r,a);const{start:i,end:c}=n.selection;e.selection.setSelectionRange({start:{row:i.row,column:i.column},end:{row:c.row,column:c.column}});const{top:s,left:l}=n.scroll;e.renderer.scrollToY(s),e.renderer.scrollToX(l)},t.Delta=(0,i.Record)({type:(0,i.Literal)("delta"),timestamp:t.AceTimestamp,focused:i.Boolean,start:t.EditorLocation,end:t.EditorLocation,action:(0,i.Union)((0,i.Literal)("insert"),(0,i.Literal)("remove")),lines:(0,i.Array)(i.String)}).And((0,i.Partial)({id:i.Number}));t.applyDelta=(e,t)=>e.session.getDocument().applyDelta(t),t.Selection=(0,i.Record)({start:t.EditorLocation,end:t.EditorLocation});t.compareSelections=(e,n)=>(0,t.compareEditorLocations)(e.start,n.start)&&(0,t.compareEditorLocations)(e.end,n.end);t.selectionIsEmpty=e=>e.start.column===e.end.column&&e.start.row===e.end.row,t.SelectionChange=(0,i.Record)({type:(0,i.Literal)("selectionchange"),timestamp:t.AceTimestamp,focused:i.Boolean,start:t.EditorLocation,end:t.EditorLocation});t.applySelectionChange=(e,t)=>e.selection.setSelectionRange(t),t.CursorChange=(0,i.Record)({type:(0,i.Literal)("cursorchange"),timestamp:t.AceTimestamp,focused:i.Boolean,location:t.EditorLocation});t.applyCursorChange=(e,t)=>e.selection.moveCursorTo(t.location.row,t.location.column),t.ScrollPosition=(0,i.Record)({top:i.Number,left:i.Number}),t.ScrollChange=(0,i.Record)({type:(0,i.Literal)("scrollchange"),timestamp:t.AceTimestamp,focused:i.Boolean,top:i.Number,left:i.Number});t.applyScrollChange=(e,t)=>{e.renderer.scrollToY(t.top),e.renderer.scrollToX(t.left)},t.WindowSize=(0,i.Record)({top:i.Number,bottom:i.Number}),t.WindowSizeChange=(0,i.Record)({type:(0,i.Literal)("windowsizechange"),timestamp:t.AceTimestamp,focused:i.Boolean,top:i.Number,bottom:i.Number}),t.ExternalChange=(0,i.Record)({type:(0,i.Literal)("external"),timestamp:t.AceTimestamp}),t.AceRecord=(0,i.Union)(t.Complete,t.Delta,t.SelectionChange,t.CursorChange,t.ScrollChange,t.WindowSizeChange,t.ExternalChange);t.applyAceRecord=(e,n)=>{t.Complete.guard(n)?(0,t.applyComplete)(e,n):t.Delta.guard(n)?(0,t.applyDelta)(e,n):t.SelectionChange.guard(n)?(0,t.applySelectionChange)(e,n):t.CursorChange.guard(n)?(0,t.applyCursorChange)(e,n):t.ScrollChange.guard(n)&&(0,t.applyScrollChange)(e,n)};t.deserializeAceRecordTimestamp=e=>(e.timestamp=new Date(e.timestamp),e);t.stream=(e,n)=>{let o=!0,r=e.getValue();const a=a=>{o&&e.getValue()!==r&&(r=e.getValue(),n(t.Delta.check(Object.assign({type:"delta",timestamp:new Date,focused:e.isFocused()},a))))};let i=t.Selection.check(e.selection.getRange());const s=(0,c.throttle)(100,(()=>{if(!o)return;const r=t.Selection.check(e.selection.getRange());(0,t.compareSelections)(r,i)||(0,t.selectionIsEmpty)(r)?i=r:(i=r,n(t.SelectionChange.check(Object.assign({type:"selectionchange",timestamp:new Date,focused:e.isFocused()},r))))}));let l=t.EditorLocation.check(e.selection.getCursor());const d=(0,c.throttle)(100,(()=>{if(!o)return;const r=t.EditorLocation.check(e.selection.getCursor());!(0,t.compareEditorLocations)(r,l)&&(0,t.selectionIsEmpty)(e.selection.getRange())?(l=r,n(t.CursorChange.check({type:"cursorchange",timestamp:new Date,focused:e.isFocused(),location:r}))):l=r}));let u=t.ScrollPosition.check({top:e.renderer.getScrollTop(),left:e.renderer.getScrollLeft()});const p=(0,c.throttle)(100,(()=>{if(!o)return;const r=t.ScrollPosition.check({top:e.renderer.getScrollTop(),left:e.renderer.getScrollLeft()});r.top===u.top&&r.left===u.left||(u=r,n(t.ScrollChange.check(Object.assign({type:"scrollchange",timestamp:new Date,focused:e.isFocused()},r))))}));let m=t.WindowSize.check({top:e.renderer.getScrollTopRow(),bottom:e.renderer.getScrollBottomRow()});const h=(0,c.throttle)(100,(()=>{if(!o)return;const r=t.WindowSize.check({top:e.renderer.getScrollTopRow(),bottom:e.renderer.getScrollBottomRow()});r.top===m.top&&r.bottom===m.bottom||(m=r,n(t.WindowSizeChange.check(Object.assign({type:"windowsizechange",timestamp:new Date,focused:e.isFocused()},r))))}));let g;e.session.addEventListener("change",a),e.addEventListener("changeSelection",s),e.addEventListener("changeSelection",d),e.session.addEventListener("changeScrollTop",p),e.session.addEventListener("changeScrollTop",h);return{stop:()=>{clearTimeout(g),e.session.removeEventListener("change",a),e.removeEventListener("changeSelection",s),e.removeEventListener("changeSelection",d),e.session.removeEventListener("changeScrollTop",p)},pause:()=>{clearTimeout(g),o=!1},restart:()=>{g=setTimeout((()=>{o=!0}),200)}}};t.record=(e,n={interval:1e3})=>{const o=n.interval||1e3,r=[(0,t.getComplete)(e)],{stop:a}=(0,t.stream)(e,(e=>r.push(e))),i=setInterval((()=>r.push((0,t.getComplete)(e))),o);return{stop:()=>(clearInterval(i),a(),r.push((0,t.getComplete)(e)),r),addExternalChange:e=>{r.push(t.ExternalChange.check(Object.assign(Object.assign({},e),{type:"external",timestamp:new Date})))}}};const s=e=>new Promise((t=>setTimeout(t,e)));t.replay=(e,n,r={start:0,seek:!1},a)=>{const i={};let c,l=!1;return i.promise=new Promise((e=>{c=e})),Promise.resolve().then((()=>o(this,void 0,void 0,(function*(){const o=r.start||0,i=e.renderer,d=i.$cursorLayer.isVisible;i.$cursorLayer.isVisible=!0;const u=i.$cursorLayer.isBlinking;i.$cursorLayer.setBlinking(!0);const p=i.$cursorLayer.element.style.opacity;i.$cursorLayer.element.style.opacity=1;const m=(new Date).valueOf(),h=new Date(n[0].timestamp).valueOf();let g=0;if(o>0){let e=0;for(;e<n.length;e++){const r=n[e];new Date(r.timestamp).valueOf()-h<o&&t.Complete.guard(r)&&(g=e)}}if(r.seek)return(0,t.applyAceRecord)(e,n[g]),c();for(let c=g;c<n.length&&!l;c++){const i=n[c];if(null===a||void 0===a||a.emit("timestamp",i.timestamp),t.ExternalChange.guard(i)&&r.onExternalChange?r.onExternalChange(i):(0,t.applyAceRecord)(e,i),n[c+1]){const e=m+(new Date(n[c+1].timestamp).valueOf()-(h+o))-(new Date).valueOf();e>0&&(yield s(e))}}i.$cursorLayer.element.style.opacity=p,i.$cursorLayer.setBlinking(u),i.$cursorLayer.isVisible=d,c()})))),i.stop=()=>{l=!0},i};t.safeChangeValue=(e,t)=>{const n=e.session.selection.toJSON();e.setValue(t),e.session.selection.fromJSON(n)};t.recordreplayer=e=>{let n,o,r,i;const c=(0,a.default)(),s=e=>{r=e,c.emit("state",r)};s("notrace");const l=()=>{if(!i)throw new Error("Replayer was not started");i.stop(),i=void 0,s("hastrace")};return{startRecording:n=>{if(o)throw new Error("Recorder is still running");o=(0,t.record)(e,n),s("recording")},stopRecording:()=>{if(!o)throw new Error("Recorder was not started");n=o.stop(),o=void 0,s("hastrace"),c.emit("newtrace",n)},startPlaying:o=>{if(!n)throw new Error("Recording not available");if(i)throw new Error("Replayer is still running");i=(0,t.replay)(e,n,o,c),i.promise.then((()=>l())),s("playing")},stopPlaying:l,clearTrace:()=>{i&&i.stop(),i=void 0,n=[],s("notrace")},events:c}}},2309:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,a){function i(e){try{s(o.next(e))}catch(t){a(t)}}function c(e){try{s(o.throw(e))}catch(t){a(t)}}function s(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}s((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.record=t.injectMetadata=void 0;const r=n(7341);t.injectMetadata=function(e){return o(this,void 0,void 0,(function*(){const t=new r.Decoder,n=new r.Reader;n.logging=!1,n.drop_default_duration=!1;const o=yield function(e){return new Promise(((t,n)=>{const o=new FileReader;o.readAsArrayBuffer(e),o.onloadend=()=>{t(o.result)},o.onerror=e=>{n(e)}}))}(e);t.decode(o).forEach((e=>{n.read(e)})),n.stop();const a=r.tools.makeMetadataSeekable(n.metadatas,n.duration,n.cues),i=o.slice(n.metadataSize);return new Blob([a,i],{type:e.type})}))};t.record=()=>o(this,void 0,void 0,(function*(){const e=new MediaRecorder(yield navigator.mediaDevices.getUserMedia({audio:!0}));let n=!0;const r=[];let a;const i=new Promise((e=>{a=e}));e.addEventListener("dataavailable",(({data:e})=>o(this,void 0,void 0,(function*(){const o=yield(0,t.injectMetadata)(e);r.push(o),n||a(window.URL.createObjectURL(new Blob(r)))})))),e.start();return{stop:()=>o(this,void 0,void 0,(function*(){if(n&&"inactive"!==e.state)return n=!1,e.stop(),e.stream.getTracks()[0].stop(),i}))}}))},4612:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return w}});var o=n(6952),r=n(5944),a=n(8742),i=n.n(a),c=n(6792),s=n(2309),l=n(8617),d=n(7378),u=n(7118),p=n.n(u),m=n(4246),h=function(e){var t=e.replayer,n=(0,d.useState)("notrace"),o=n[0],r=n[1];return(0,d.useEffect)((function(){t.events.on("state",(function(e){return r(e)})),t.events.on("timestamp",(function(e){return console.log(e)}))}),[]),(0,m.jsxs)("div",{style:{display:"flex",width:"100%",flexDirection:"row",alignItems:"center"},children:[(0,m.jsx)("button",{disabled:"notrace"===o||"playing"===o||"recording"===o,onClick:function(){return t.startPlaying()},children:"Play"}),(0,m.jsx)("button",{disabled:"notrace"!==o,onClick:function(){return t.startRecording()},children:"Record"}),(0,m.jsx)("button",{disabled:"recording"!==o&&"playing"!==o,onClick:function(){"recording"===o?t.stopRecording():t.stopPlaying()},children:"Stop"}),(0,m.jsx)("button",{disabled:"notrace"===o||"playing"===o||"recording"===o,onClick:function(){return t.clearTrace()},children:"Clear"})]})},g=(0,l.default)((function(){return Promise.all([n.e(774),n.e(90),n.e(329)]).then(n.bind(n,2329))}),{ssr:!1,loadableGenerated:{webpack:function(){return[2329]},modules:["index.tsx -> react-ace"]}}),f=function(){var e=(0,d.useState)([]),t=e[0],n=e[1];return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("h2",{children:"Single Editor Stream Demo"}),(0,m.jsx)("p",{children:"Live edits are streamed below the editor."}),(0,m.jsx)(g,{mode:"java",theme:"github",width:"100%",height:"16rem",minLines:16,maxLines:1/0,showPrintMargin:!1,onBeforeLoad:function(e){e.config.set("basePath","https://cdn.jsdelivr.net/npm/ace-builds@".concat(e.version,"/src-min-noconflict"))},onLoad:function(e){(0,c.stream)(e,(function(e){n((function(t){return[e].concat((0,r.Z)(t))}))}))}}),(0,m.jsx)("button",{onClick:function(){return n([])},style:{marginTop:8},children:"Clear"}),(0,m.jsx)("div",{style:{height:"16rem",overflow:"scroll",marginTop:8},children:t.map((function(e,t){return(0,m.jsx)("pre",{children:JSON.stringify(e,null,2)},t)}))})]})},y=function(){var e=(0,d.useState)("notrace"),t=(e[0],e[1],(0,d.useState)(void 0)),n=t[0],o=t[1];return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("h2",{children:"Single Editor Record and Replay Demo"}),(0,m.jsx)("p",{children:"Use the record button to start recording, and replay to replay when you are finished."}),n&&(0,m.jsx)(h,{replayer:n}),(0,m.jsx)(g,{mode:"java",theme:"github",width:"100%",height:"16rem",minLines:16,maxLines:1/0,showPrintMargin:!1,onBeforeLoad:function(e){e.config.set("basePath","https://cdn.jsdelivr.net/npm/ace-builds@".concat(e.version,"/src-min-noconflict"))},onLoad:function(e){o((0,c.recordreplayer)(e))}})]})},v=function(){var e=(0,d.useState)(!1),t=e[0],n=e[1],r=(0,d.useRef)(),a=(0,d.useState)(),c=a[0],l=a[1];return(0,d.useEffect)((function(){(function(){var e=(0,o.Z)(i().mark((function e(t){var n,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=7;break}return null===(n=r.current)||void 0===n||n.stop(),e.next=4,(0,s.record)();case 4:r.current=e.sent,e.next=12;break;case 7:return e.t0=l,e.next=10,null===(o=r.current)||void 0===o?void 0:o.stop();case 10:e.t1=e.sent,(0,e.t0)(e.t1);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}})()(t)}),[t]),(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("h2",{children:"Audio Recording Demo"}),(0,m.jsxs)("div",{style:{display:"flex"},children:[(0,m.jsx)("button",{onClick:function(){return c?l(void 0):n((function(e){return!e}))},children:c?"Clear":t?"Stop":"Record"}),t&&(0,m.jsx)(p(),{children:function(){return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(p().Minutes,{}),":",(0,m.jsx)(p().Seconds,{})]})}}),c&&(0,m.jsx)("audio",{controls:!0,src:c})]})]})};function w(){return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(y,{}),(0,m.jsx)(v,{}),(0,m.jsx)(f,{})]})}},4423:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(4612)}])}},function(e){e.O(0,[774,186,888,179],(function(){return t=4423,e(e.s=t);var t}));var t=e.O();_N_E=t}]);